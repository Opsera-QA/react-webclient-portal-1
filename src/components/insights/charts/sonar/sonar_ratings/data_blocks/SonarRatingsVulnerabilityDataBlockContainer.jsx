import React, {useContext} from "react";
import PropTypes from "prop-types";
import { DialogToastContext } from "contexts/DialogToastContext";
import {LETTER_GRADES} from "components/common/metrics/grade/MetricLetterGradeText";
import HorizontalDataBlocksContainer from "components/common/metrics/data_blocks/horizontal/HorizontalDataBlocksContainer";
import TwoLineScoreDataBlock from "components/common/metrics/score/TwoLineScoreDataBlock";
import TwoLineGradeDataBlock from "components/common/metrics/grade/TwoLineGradeDataBlock";
import Col from "react-bootstrap/Col";
import SonarRatingsVulnerabilityActionableInsightOverlay from 'components/insights/charts/sonar/sonar_ratings/actionable_insights/vulnerability/SonarRatingsVulnerabilityActionableInsightOverlay';
import Row from "react-bootstrap/Row";
import StandardTwoGoalDataBlock from "components/common/metrics/goals/double/StandardTwoGoalDataBlock";

function SonarRatingsVulnerabilityDataBlockContainer({  securityRating, vulnerabilityCount }) {
  const toastContext = useContext(DialogToastContext);
  
  const onRowSelect =()=>{    
    toastContext.showOverlayPanel(
      <SonarRatingsVulnerabilityActionableInsightOverlay />
    );
  };

  const getSonarSecurityGrade = (rating) => {
    if (rating <= 1) {
      return LETTER_GRADES.A;
    }
    else if (rating <= 2) {
      return LETTER_GRADES.B;
    }
    else if (rating <= 3) {
      return LETTER_GRADES.C;
    }
    else if (rating <= 4) {
      return LETTER_GRADES.D;
    }
    else if (rating <= 5) {
      return LETTER_GRADES.E;
    }
    else {
      return "ERROR";
    }
  };

  const getLeftDataBlock = () => {
    return (
      <TwoLineGradeDataBlock
        letterGrade={getSonarSecurityGrade(securityRating)}
        subtitle={"Security"}
      />
    );
  };

  const getMiddleDataBlock = () => {
    return (
      <TwoLineScoreDataBlock
        score={vulnerabilityCount}
        subtitle={"Vulnerabilities"}
      />
    );
  };

  const getRightDataBlock = () => {
    return (
      <StandardTwoGoalDataBlock
        topGoal={"Security: A"}
        bottomGoal={"Vulnerabilities: 0 - 1"}
      />
    );
  };

  return (
    <HorizontalDataBlocksContainer
      title={"Sonar Ratings: Security"}
      onClick={() => onRowSelect()}
    >
      <Col sm={4}>
        {getLeftDataBlock()}
      </Col>
      <Col sm={4}>
        {getMiddleDataBlock()}
      </Col>
      <Col sm={4}>
        {getRightDataBlock()}
      </Col>
    </HorizontalDataBlocksContainer>
  );
}

SonarRatingsVulnerabilityDataBlockContainer.propTypes = {
  securityRating: PropTypes.number,
  vulnerabilityCount: PropTypes.number,
};

export default SonarRatingsVulnerabilityDataBlockContainer;
